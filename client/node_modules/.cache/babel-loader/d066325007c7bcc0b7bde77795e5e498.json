{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maestro/Documents/repos/blogapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/maestro/Documents/repos/blogapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/maestro/Documents/repos/blogapp/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useContext,useState}from\"react\";import\"./write.css\";import axios from\"axios\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var axiosInstance=axios.create({baseURL:process.env.REACT_APP_API_URL});var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axiosInstance.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axiosInstance.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"sources":["/Users/maestro/Documents/repos/blogapp/client/src/pages/write/Write.jsx"],"names":["useContext","useState","axios","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","axiosInstance","create","baseURL","process","env","REACT_APP_API_URL","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"mappings":"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","sourcesContent":["import { useContext, useState } from \"react\";\nimport \"./write.css\";\nimport axios from \"axios\";\nimport { Context } from \"../../context/Context\";\n\nexport default function Write() {\n  const [title, setTitle] = useState(\"\");\n  const [desc, setDesc] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const { user } = useContext(Context);\n\n  const axiosInstance = axios.create ({\n    baseURL: process.env.REACT_APP_API_URL,\n  }); \n\n  const handleSubmit = async (e) => {\n\n\n    e.preventDefault();\n    const newPost = {\n      username: user.username,\n      title,\n      desc,\n    };\n    if (file) {\n      const data =new FormData();\n      const filename = Date.now() + file.name;\n      data.append(\"name\", filename);\n      data.append(\"file\", file);\n      newPost.photo = filename;\n      try {\n        await axiosInstance.post(\"/upload\", data);\n      } catch (err) {      \n        \n        // error to browser\n      }\n\n      \n    }\n    try {\n      const res = await axiosInstance.post(\"/posts\", newPost);\n      window.location.replace(\"/post/\" + res.data._id);\n\n    } catch (err) {\n      \n    }\n  };\n  return (\n    <div className=\"write\">\n      {file && (\n        <img className=\"writeImg\" src={URL.createObjectURL(file)} alt=\"\" />\n      )}\n      <form className=\"writeForm\" onSubmit={handleSubmit}>\n        <div className=\"writeFormGroup\">\n          <label htmlFor=\"fileInput\">\n            <i className=\"writeIcon fas fa-plus\"></i>\n          </label>\n          <input\n            type=\"file\"\n            id=\"fileInput\"\n            style={{ display: \"none\" }}\n            onChange={(e) => setFile(e.target.files[0])}\n          />\n          <input\n            type=\"text\"\n            placeholder=\"Title\"\n            className=\"writeInput\"\n            autoFocus={true}\n            onChange={e=>setTitle(e.target.value)}\n          />\n        </div>\n        <div className=\"writeFormGroup\">\n          <textarea\n            placeholder=\"Tell your story...\"\n            type=\"text\"\n            className=\"writeInput writeText\"\n            onChange={e=>setDesc(e.target.value)}\n          ></textarea>\n        </div>\n        <button className=\"writeSubmit\" type=\"submit\">\n          Publish\n        </button>\n      </form>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}